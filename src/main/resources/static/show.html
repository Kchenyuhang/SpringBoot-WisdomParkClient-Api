<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Floor View</title>
    <script src="/js/websocket.js"></script>
    <script src="/js/jquery.min.js"></script>
    <script src="/js/sockjs.min.js"></script>
    <script src="/js/stomp.min.js"></script>
    <script id="code">
        //--------stomp
        var DEBUG_FLAG = true;
        $(function () {
            //启动websocket
            connect();
        });

        function send() {
            var msg = $("#msg").val();
            //第一部分为后端处理的地址，第二部分head头（认证的消息），第三部分为内容
            stompClient.send("/send", {}, msg);
        }

        function sendToAll() {
            var msg = $("#msg").val();
            //第一部分为后端处理的地址，第二部分head头（认证的消息），第三部分为内容
            stompClient.send("/sendToAll", {}, msg);
        }

        function sendToUser() {
            var msg = $("#msg").val();
            var toUserId = $("#userId").val();
            //第一部分为后端处理的地址，第二部分head头（认证的消息），第三部分为内容
            var data = {"fromUserId": userId, "toUserId": toUserId, "msg": msg}
            stompClient.send("/sendToUser", {}, JSON.stringify(data));
        }


        // --------websocket
        // var DEBUG_FLAG = true;
        // $(function () {
        //     //启动websocket
        //     createWebSocket();
        //
        // });
        //
        // // 当有消息推送后触发下面事件
        // function onWsMessage(evt) {
        //     var jsonStr = evt.data;
        //     writeToScreen(jsonStr);
        // }
        //
        // function writeToScreen(message) {
        //     if (DEBUG_FLAG) {
        //         $("#debuggerInfo").val($("#debuggerInfo").val() + "\n" + message);
        //     }
        // }
        //
        // // 直接发送给后台
        // function sendMessageBySocket() {
        //     var msg = $("#msg").val();
        //     wsObj.send(msg);
        // }
        //
        // // 发送给指定用户
        // function sendToUser() {
        //     var msg = $("#msg").val();
        //     var toUserId = $("#userId").val();
        //     var data = {"fromUserId": userId, "toUserId": toUserId, "msg": msg};
        //     wsObj.send(JSON.stringify(data))
        // }
    </script>
</head>

<body style="margin: 0px;padding: 0px;overflow: hidden; ">
<!-- 显示消息-->
<textarea id="debuggerInfo" style="width:100%;height:200px;"></textarea>
<!-- 发送消息-->
<div>消息：<input type="text" id="msg"></input></div>
<div>用户：<input type="text" id="userId"></input></div>
<!--<div><input type="button" value="发送消息" onclick="sendMessageBySocket()"></input></div>-->

<!--<div>用户：<input type="text" id="userId"></input></div>-->
<!--<div><input type="button" value="发送消息" onclick="sendToUser()"></input></div>-->

<div><input type="button" value="发送消息" onclick="send()"></input></div>
<div><input type="button" value="群发消息" onclick="sendToAll()"></input></div>
<div><input type="button" value="单独给用户发信息" onclick="sendToUser()"></input></div>
</body>
</html>